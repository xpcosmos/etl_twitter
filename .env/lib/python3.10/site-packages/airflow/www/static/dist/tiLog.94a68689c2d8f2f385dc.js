/*! For license information please see tiLog.94a68689c2d8f2f385dc.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.tiLog=t():(e.Airflow=e.Airflow||{},e.Airflow.tiLog=t())}(window,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=124)}({124:function(e,t,n){"use strict";n.r(t);var o=n(5),r=n(2),a=n(3);const i=Object(r.c)("execution_date"),c=Object(r.c)("dag_id"),m=Object(r.c)("task_id"),d=Object(r.c)("map_index"),l=Object(r.c)("logs_with_metadata_url"),s=parseInt(Object(r.c)("delay"),10),u=parseInt(Object(r.c)("auto_tailing_offset"),10),f=parseInt(Object(r.c)("animation_speed"),10),p=parseInt(Object(r.c)("total_attempts"),10);function g(){$("html, body").animate({scrollTop:$(document).height()},f)}function h(e,t=null,n=!1){return console.debug(`Auto-tailing log for dag_id: ${c}, task_id: ${m}, execution_date: ${i}, map_index: ${d}, try_number: ${e}, metadata: ${JSON.stringify(t)}`),Promise.resolve($.ajax({url:l,data:{dag_id:c,task_id:m,map_index:d,execution_date:i,try_number:e,metadata:JSON.stringify(t)}})).then((t=>{if(t){if(t.error)return t.message&&console.error(`Error while retrieving log: ${t.message}`),void(document.getElementById(`loading-${e}`).style.display="none");if(t.message){let r=!1;n&&function(){const e=$(document).height();return console.debug($(window).scrollTop()),console.debug($(window).height()),console.debug($(document).height()),0!==$(window).scrollTop()&&$(window).scrollTop()+$(window).height()>e-u}()&&(r=!0);const i=/http(s)?:\/\/[\w.-]+(\.?:[\w.-]+)*([/?#][\w\-._~:/?#[\]@!$&'()*+,;=.%]+)?/g,c=/\d{4}[./-]\d{2}[./-]\d{2} \d{2}:\d{2}:\d{2},\d{3}/g;t.message.forEach((t=>{const n=`try-${e}-${t[0]}`;let r=document.getElementById(n);if(!r){const t=document.createElement("div"),o=document.createElement("pre");t.appendChild(o),o.innerHTML=`<code id="${n}"  ></code>`,document.getElementById(`log-group-${e}`).appendChild(t),r=document.getElementById(n)}const m=Object(o.escapeHtml)(t[1]).replace(i,(e=>`<a href="${e}" target="_blank">${e}</a>`)).replaceAll(c,(e=>`<time datetime="${e}+00:00" data-with-tz="true">${Object(a.f)(`${e}+00:00`)}</time>`));r.innerHTML+=`${m}\n`})),r&&g()}t.metadata.end_of_log?document.getElementById(`loading-${e}`).style.display="none":function(e=s){return new Promise((t=>setTimeout(t,e)))}().then((()=>h(e,t.metadata,n)))}else document.getElementById(`loading-${e}`).style.display="none"}))}function b(e){e||(e=$("#ti_log_try_number_list .active a").data("try-number"));const t=new URLSearchParams({dag_id:c,task_id:m,execution_date:i,try_number:e,metadata:"null",format:"file"}),n=`${l}?${t}`;$("#ti_log_download_active").attr("href",n)}window.toggleWrapLogs=function(){$("pre code").toggleClass("wrap")},window.scrollBottomLogs=g,$(document).ready((()=>{for(let e=p;e>=1;e-=1){h(e,null,e===p)}b(),$("#ti_log_try_number_list a").click((function(){b($(this).data("try-number"))}))}))},2:function(e,t,n){"use strict";function o(e){const t=document.querySelector(`meta[name="${e}"]`);return t?t.getAttribute("content"):null}n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));const r=()=>new Map([["success",0],["failed",0],["upstream_failed",0],["up_for_retry",0],["up_for_reschedule",0],["running",0],["deferred",0],["sensing",0],["queued",0],["scheduled",0],["skipped",0],["no_status",0]]),a=(e,t)=>{const n=e.includes("?")?"&":"?";return`${e}${n}${t}`}},3:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"k",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return m})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"l",(function(){return u})),n.d(t,"i",(function(){return f})),n.d(t,"g",(function(){return p})),n.d(t,"b",(function(){return g}));const o="YYYY-MM-DD, HH:mm:ss",r="YYYY-MM-DDTHH:mm:ss.SSS",a="YYYY-MM-DD, HH:mm:ss z",i="z (Z)",c="YYYY-MM-DDThh:mm:ssTZD",m="timezone";function d(e){return e instanceof moment?e.isUTC()?"UTC":e.format(i):"UTC"===e?e:moment().tz(e).format(i)}function l(e,t){const n=moment(e),r=$.extend({title:!0},t).title,a=document.createElement("time");return a.setAttribute("datetime",n.format()),r&&a.setAttribute("title",n.isUTC()?"":`UTC: ${n.clone().utc().format()}`),a.innerText=n.format(o),a}const s=e=>moment(e).format(a);function u(e){moment.tz.setDefault(e),$('time[data-datetime-convert!="false"]').each(((e,t)=>{const n=$(t),r=moment(n.attr("datetime"));r._isValid&&n.text(r.format(n.data("with-tz")?a:o)),void 0!==n.attr("title")&&n.attr("title",r.isUTC()?"":`UTC: ${r.clone().utc().format()}`)})),$(".datetime input").each(((e,t)=>{t.value=moment(t.value).format()}))}const f=(e,t)=>moment(t||void 0).diff(e||void 0),p=e=>{const t=moment.duration(e),n=t.days();return`${n>0?`${n}d`:""}${moment.utc(t.as("milliseconds")).format("HH:mm:ss")}`},g=e=>`${moment(e).fromNow()}`},5:function(e,t,n){"use strict";n.r(t),n.d(t,"escapeHtml",(function(){return c})),n.d(t,"convertSecsToHumanReadable",(function(){return m}));var o=n(3);function r(){const e=moment();$("#clock").attr("datetime",e.format(o.c)).html(`${e.format("HH:mm")} <strong>${Object(o.h)(e)}</strong>`)}function a(e){localStorage.setItem("selected-timezone",e);const t=new Event(o.a);t.value=e,t.key="selected-timezone",document.dispatchEvent(t),Object(o.l)(e),r(),$("body").trigger({type:"airflow.timezone-change",timezone:e})}window.isoDateToTimeEl=o.j,window.moment=Airflow.moment;const i=document.createElement("span");function c(e){return i.textContent=e,i.innerHTML}function m(e){const t=e,n=t-Math.floor(t);e=Math.floor(e);const o=Math.floor(e/3600);e-=3600*o;const r=Math.floor(e/60);let a="";return o>0&&(a+=`${o}Hours `),r>0&&(a+=`${r}Min `),(e-=60*r)+n>0&&(Math.floor(t)===t?a+=`${e}Sec`:a+=`${(e+=n).toFixed(3)}Sec`),a}window.escapeHtml=c,window.convertSecsToHumanReadable=m,window.postAsForm=function(e,t){const n=$("<form></form>");n.attr("method","POST"),n.attr("action",e),$.each(t||{},((e,t)=>{const o=$("<input></input>");o.attr("type","hidden"),o.attr("name",e),o.attr("value",t),n.append(o)}));const o=$("<input></input>");o.attr("type","hidden"),o.attr("name","csrf_token"),o.attr("value",csrfToken),n.append(o),$(document.body).append(n),n.submit()},$(document).ready((()=>{!function(){const e=moment.tz.guess(),t=localStorage.getItem("selected-timezone"),n=localStorage.getItem("chosen-timezone");function r(t){localStorage.setItem("chosen-timezone",t),t!==e||t!==Airflow.serverTimezone?($("#timezone-manual a").data("timezone",t).text(Object(o.h)(t)),$("#timezone-manual").show()):$("#timezone-manual").hide()}n&&r(n),a(t||Airflow.defaultUITimezone),"UTC"!==Airflow.serverTimezone&&($("#timezone-server a").html(`${Object(o.h)(Airflow.serverTimezone)} <span class="label label-primary">Server</span>`),$("#timezone-server").show()),Airflow.serverTimezone!==e?$("#timezone-local a").attr("data-timezone",e).html(`${Object(o.h)(e)} <span class="label label-info">Local</span>`):$("#timezone-local").hide(),$("a[data-timezone]").click((e=>{a($(e.currentTarget).data("timezone"))})),$("#timezone-other").typeahead({source:$(moment.tz.names().map((e=>({category:e.split("/",1)[0],name:e.replace("_"," "),tzName:e})))),showHintOnFocus:"all",showCategoryHeader:!0,items:"all",afterSelect(e){this.$element.val(""),r(e.tzName),a(e.tzName),setTimeout((()=>{document.activeElement.blur(),this.shown=!1,this.focused=!1}),1)}})}(),$("#clock").attr("data-original-title",hostName).attr("data-placement","bottom").parent().show(),r(),setInterval(r,1e3),$.ajaxSetup({beforeSend(e,t){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(t.type)||this.crossDomain||e.setRequestHeader("X-CSRFToken",csrfToken)}}),$.fn.datetimepicker.defaults.format="YYYY-MM-DD HH:mm:ssZ",$.fn.datetimepicker.defaults.sideBySide=!0,$(".datetimepicker").datetimepicker(),$("#filter_form a.filter").click((()=>{$(".datetimepicker").datetimepicker()})),$(".js-tooltip").tooltip()}))}})}));